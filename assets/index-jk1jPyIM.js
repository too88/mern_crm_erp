import{ao as e,aD as I,aq as E,a as A}from"./index-PXb9zWLD.js";import{H as h,a1 as n,_ as p,$ as F,a0 as T,Y as o,a2 as L,a3 as S,G as i,E as D,X as B,a4 as R,V as w,W as y}from"./MernOs-qaQ5bbZr.js";import{S as k}from"./selector-kZgu6KfM.js";import{D as q,j as M,u as _,e as U,C as z,a as Y,b as H,s as V,d as W,R as $,U as G,S as X}from"./useOnFetch-FPN0ClPk.js";import{c as j}from"./action-XTLgilpi.js";import{r as J}from"./ErpApp-cqodzhCS.js";import{P as K}from"./PlusOutlined-b6vIljC1.js";function b({isUpdateForm:t=!1}){const a=h();return e.jsxs(e.Fragment,{children:[e.jsx(n.Item,{label:a("firstname"),name:"name",rules:[{required:!0}],children:e.jsx(p,{autoComplete:"off"})}),e.jsx(n.Item,{label:a("lastname"),name:"surname",rules:[{required:!0}],children:e.jsx(p,{autoComplete:"off"})}),e.jsx(n.Item,{label:a("email"),name:"email",rules:[{required:!0},{type:"email"}],children:e.jsx(p,{autoComplete:"off"})}),!t&&e.jsx(n.Item,{label:a("Password"),name:"password",rules:[{required:!0}],children:e.jsx(p,{autoComplete:"new-password"})}),e.jsx(n.Item,{label:a("enabled"),name:"enabled",valuePropName:"checked",children:e.jsx(k,{checkedChildren:e.jsx(F,{}),unCheckedChildren:e.jsx(T,{})})}),e.jsx(n.Item,{label:a("role"),name:"role",rules:[{required:!0}],children:e.jsxs(o,{children:[e.jsx(o.Option,{value:"admin",children:a("admin_super_admin")}),e.jsx(o.Option,{value:"staffAdmin",children:a("staff_admin_crud")}),e.jsx(o.Option,{value:"staff",children:a("staff_crud")}),e.jsx(o.Option,{value:"createOnly",children:a("create_and_read_only")}),e.jsx(o.Option,{value:"readOnly",children:a("read_only")})]})})]})}function Q({config:t}){const a=h();return e.jsx(q,{config:t,extra:[{label:a("update_password"),key:"updatePassword",icon:e.jsx(L,{})}]})}function Z(){const t=I(),a=h(),{current:s}=E(M),{state:r,crudContextAction:c}=_(),{readBox:u}=c,{isAdvancedBoxOpen:m}=r,[d]=n.useForm(),{onFetch:l,isLoading:x,isSuccess:C}=U(),f=P=>{const v="admin/password-update/"+s._id,g=(async()=>await J.patch({entity:v,jsonData:P}))();l(g)},N=()=>{u.open()},O=m?{display:"block",opacity:1}:{display:"none",opacity:0};return A.useEffect(()=>{C&&(d.resetFields(),t(j.resetAction({actionType:"update"})))},[C]),e.jsx("div",{style:O,children:e.jsxs(S,{isLoading:x,children:[e.jsx("h3",{children:a("update_password")}),e.jsx("div",{className:"space10"}),e.jsxs(n,{form:d,layout:"vertical",onFinish:f,children:[e.jsx(n.Item,{label:a("new_password"),name:"password",rules:[{required:!0}],children:e.jsx(p.Password,{autoComplete:"new-password"})}),e.jsx(n.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(i,{type:"primary",htmlType:"submit",children:a("save")})}),e.jsx(n.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(i,{onClick:N,children:a("cancel")})})]})]})})}function ee({config:t,formElements:a}){const s=h(),{crudContextAction:r}=_(),{advancedBox:c,modal:u,editBox:m}=r,{result:d}=E(V),l=I(),x=()=>{l(j.currentAction({actionType:"delete",data:d})),u.open()},C=()=>{l(j.currentAction({actionType:"update",data:d})),m.open()},f=()=>{l(j.currentAction({actionType:"update",data:d})),c.open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space20"}),e.jsxs(D,{children:[e.jsx(i,{onClick:x,type:"text",icon:e.jsx(W,{}),size:"small",children:s("remove")}),e.jsx(i,{onClick:C,type:"text",icon:e.jsx(B,{}),size:"small",children:s("edit")}),e.jsx(i,{onClick:f,type:"text",icon:e.jsx(R,{}),size:"small",children:s("update_password")})]}),e.jsx("div",{className:"space20"}),e.jsx($,{config:t}),e.jsx(G,{config:t,formElements:a,withUpload:!0}),e.jsx(Z,{config:t})]})}function te({config:t}){const{crudContextAction:a}=_(),{collapsedBox:s}=a,r=()=>{s.open()};return e.jsxs(e.Fragment,{children:[e.jsx(w,{gutter:12,children:e.jsx(y,{className:"gutter-row",span:24,children:e.jsx("h1",{style:{fontSize:20,marginBottom:20},children:t.PANEL_TITLE})})}),e.jsxs(w,{gutter:8,children:[e.jsx(y,{className:"gutter-row",span:21,children:e.jsx(X,{config:t})}),e.jsx(y,{className:"gutter-row",span:3,children:e.jsx(i,{onClick:r,block:!0,icon:e.jsx(K,{})})})]})]})}function ae({config:t,createForm:a,updateForm:s}){const r=I();return A.useLayoutEffect(()=>{r(j.resetState())},[]),e.jsxs(z,{config:t,FixHeaderPanel:e.jsx(te,{config:t}),sidePanelBottomContent:e.jsx(Y,{config:t,formElements:a,withUpload:!0}),sidePanelTopContent:e.jsx(ee,{config:t,formElements:s}),children:[e.jsx(Q,{config:t}),e.jsx(H,{config:t})]})}const se="admin";function me(){const t=h(),a=se,s={displayLabels:["name","surname"],searchFields:"email,name,surname",outputValue:"_id"},r=["email"],c=[{title:t("first_name"),dataIndex:"name"},{title:t("last_name"),dataIndex:"surname"},{title:t("email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"}],u=[{title:t("first_name"),dataIndex:"name"},{title:t("last_name"),dataIndex:"surname"},{title:t("email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"},{title:t("enabled"),dataIndex:"enabled",onCell:()=>({props:{style:{width:"60px"}}}),render:x=>e.jsx(k,{checked:x,checkedChildren:e.jsx(F,{}),unCheckedChildren:e.jsx(T,{})})}],m={PANEL_TITLE:t("admin"),TABLE_NAME:t("admin_list"),ADD_NEW_ENTITY:t("add_new_admin"),ENTITY_NAME:t("admin"),RECORD_ENTITY:t("record_payment")},l={...{entity:a,...m},readColumns:c,dataTableColumns:u,searchConfig:s,deleteModalLabels:r};return e.jsx(ae,{createForm:e.jsx(b,{}),updateForm:e.jsx(b,{isUpdateForm:!0}),config:l})}export{me as default};
