import{r as C,k as P,j as e,au as w,an as k}from"./index-DhWFfINn.js";import{A as S,u as j,C as A,a as E,S as o,B as i,r as B,b as R}from"./ErpApp-GugGr9Bm.js";import{F as n,I as p,S as F,a as D,L as M,E as z,R as b,C as I}from"./selector-_Kdj3DXy.js";import{D as q,k as U,u as _,f as H,a as h,C as V,b as Y,d as $,s as W,e as G,R as J,U as K,S as Q}from"./useOnFetch-dyi6sCyT.js";import{P as X}from"./PlusOutlined-9_CDZQF6.js";import"./MernOs-ZcwE33eb.js";import"./selector-r3wQTJR7.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const ee=Z;var te=function(a,s){return C.createElement(S,P({},a,{ref:s,icon:ee}))};const ae=C.forwardRef(te);function v({isUpdateForm:t=!1}){const a=j();return e.jsxs(e.Fragment,{children:[e.jsx(n.Item,{label:a("firstname"),name:"name",rules:[{required:!0}],children:e.jsx(p,{autoComplete:"off"})}),e.jsx(n.Item,{label:a("lastname"),name:"surname",rules:[{required:!0}],children:e.jsx(p,{autoComplete:"off"})}),e.jsx(n.Item,{label:a("email"),name:"email",rules:[{required:!0},{type:"email"}],children:e.jsx(p,{autoComplete:"off"})}),!t&&e.jsx(n.Item,{label:a("Password"),name:"password",rules:[{required:!0}],children:e.jsx(p,{autoComplete:"new-password"})}),e.jsx(n.Item,{label:a("enabled"),name:"enabled",valuePropName:"checked",children:e.jsx(F,{checkedChildren:e.jsx(A,{}),unCheckedChildren:e.jsx(E,{})})}),e.jsx(n.Item,{label:a("role"),name:"role",rules:[{required:!0}],children:e.jsxs(o,{children:[e.jsx(o.Option,{value:"admin",children:a("admin_super_admin")}),e.jsx(o.Option,{value:"staffAdmin",children:a("staff_admin_crud")}),e.jsx(o.Option,{value:"staff",children:a("staff_crud")}),e.jsx(o.Option,{value:"createOnly",children:a("create_and_read_only")}),e.jsx(o.Option,{value:"readOnly",children:a("read_only")})]})})]})}function se({config:t}){const a=j();return e.jsx(q,{config:t,extra:[{label:a("update_password"),key:"updatePassword",icon:e.jsx(D,{})}]})}function ne(){const t=w(),a=j(),{current:s}=k(U),{state:r,crudContextAction:c}=_(),{readBox:u}=c,{isAdvancedBoxOpen:m}=r,[d]=n.useForm(),{onFetch:l,isLoading:x,isSuccess:f}=H(),y=g=>{const L="admin/password-update/"+s._id,N=(async()=>await B.patch({entity:L,jsonData:g}))();l(N)},O=()=>{u.open()},T=m?{display:"block",opacity:1}:{display:"none",opacity:0};return C.useEffect(()=>{f&&(d.resetFields(),t(h.resetAction({actionType:"update"})))},[f]),e.jsx("div",{style:T,children:e.jsxs(M,{isLoading:x,children:[e.jsx("h3",{children:a("update_password")}),e.jsx("div",{className:"space10"}),e.jsxs(n,{form:d,layout:"vertical",onFinish:y,children:[e.jsx(n.Item,{label:a("new_password"),name:"password",rules:[{required:!0}],children:e.jsx(p.Password,{autoComplete:"new-password"})}),e.jsx(n.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(i,{type:"primary",htmlType:"submit",children:a("save")})}),e.jsx(n.Item,{style:{display:"inline-block",paddingRight:"5px"},children:e.jsx(i,{onClick:O,children:a("cancel")})})]})]})})}function re({config:t,formElements:a}){const s=j(),{crudContextAction:r}=_(),{advancedBox:c,modal:u,editBox:m}=r,{result:d}=k(W),l=w(),x=()=>{l(h.currentAction({actionType:"delete",data:d})),u.open()},f=()=>{l(h.currentAction({actionType:"update",data:d})),m.open()},y=()=>{l(h.currentAction({actionType:"update",data:d})),c.open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space20"}),e.jsxs(R,{children:[e.jsx(i,{onClick:x,type:"text",icon:e.jsx(G,{}),size:"small",children:s("remove")}),e.jsx(i,{onClick:f,type:"text",icon:e.jsx(z,{}),size:"small",children:s("edit")}),e.jsx(i,{onClick:y,type:"text",icon:e.jsx(ae,{}),size:"small",children:s("update_password")})]}),e.jsx("div",{className:"space20"}),e.jsx(J,{config:t}),e.jsx(K,{config:t,formElements:a,withUpload:!0}),e.jsx(ne,{config:t})]})}function de({config:t}){const{crudContextAction:a}=_(),{collapsedBox:s}=a,r=()=>{s.open()};return e.jsxs(e.Fragment,{children:[e.jsx(b,{gutter:12,children:e.jsx(I,{className:"gutter-row",span:24,children:e.jsx("h1",{style:{fontSize:20,marginBottom:20},children:t.PANEL_TITLE})})}),e.jsxs(b,{gutter:8,children:[e.jsx(I,{className:"gutter-row",span:21,children:e.jsx(Q,{config:t})}),e.jsx(I,{className:"gutter-row",span:3,children:e.jsx(i,{onClick:r,block:!0,icon:e.jsx(X,{})})})]})]})}function le({config:t,createForm:a,updateForm:s}){const r=w();return C.useLayoutEffect(()=>{r(h.resetState())},[]),e.jsxs(V,{config:t,FixHeaderPanel:e.jsx(de,{config:t}),sidePanelBottomContent:e.jsx(Y,{config:t,formElements:a,withUpload:!0}),sidePanelTopContent:e.jsx(re,{config:t,formElements:s}),children:[e.jsx(se,{config:t}),e.jsx($,{config:t})]})}const oe="admin";function fe(){const t=j(),a=oe,s={displayLabels:["name","surname"],searchFields:"email,name,surname",outputValue:"_id"},r=["email"],c=[{title:t("first_name"),dataIndex:"name"},{title:t("last_name"),dataIndex:"surname"},{title:t("email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"}],u=[{title:t("first_name"),dataIndex:"name"},{title:t("last_name"),dataIndex:"surname"},{title:t("email"),dataIndex:"email"},{title:t("role"),dataIndex:"role"},{title:t("enabled"),dataIndex:"enabled",onCell:()=>({props:{style:{width:"60px"}}}),render:x=>e.jsx(F,{checked:x,checkedChildren:e.jsx(A,{}),unCheckedChildren:e.jsx(E,{})})}],m={PANEL_TITLE:t("admin"),TABLE_NAME:t("admin_list"),ADD_NEW_ENTITY:t("add_new_admin"),ENTITY_NAME:t("admin"),RECORD_ENTITY:t("record_payment")},l={...{entity:a,...m},readColumns:c,dataTableColumns:u,searchConfig:s,deleteModalLabels:r};return e.jsx(le,{createForm:e.jsx(v,{}),updateForm:e.jsx(v,{isUpdateForm:!0}),config:l})}export{fe as default};
